##################
#This file imputes missing values of continuous data using random imputation
#This example uses an anthropological dataset that has 5% missing data
#Examines the success of random imputation of these data against the complete dataset
#################

#This approach uses the R package 'mice'
#The R package 'irr' is used for Cohen's kappa
#continuousdata.csv = the full dataset (used only for evaluating level of success)
#one.csv = the csv file that has 5% missing values

**Variable Names**
#FL_L - femur length left
#FL_R - femur length right
#T1.AP - T1 antero-posterior length
#T1.TR - T1 transverse length
#L1.AP - L1 antero-posterior length
#L1.TR - L1 transverse length

###################################
Set up workspace and load libraries
###################################

rm(list=ls())

library(mice)
library(irr)

setwd("C:/Users/Amanda Wissler/Documents/Spring/imputation")
dat<-read.csv("continuousdata.csv", header=T)

#Load the datasets that have 5% missing data. In this case I have 5 different datasets. 
cont.five.1<-read.csv("cont.five.1.csv", header=T)
cont.five.2<-read.csv("cont.five.2.csv", header=T)
cont.five.3<-read.csv("cont.five.3.csv", header=T)
cont.five.4<-read.csv("cont.five.4.csv", header=T)
cont.five.5<-read.csv("cont.five.5.csv", header=T)

#Establish the mean and variance for the complete dataset so you can evaluate imputed values
FL.Ldatmean<-mean(dat$FL_Left)
FL.Rdatmean<-mean(dat$FL_Right)
T1.APdatmean<-mean(dat$T1.AP)
T1.TRdatmean<-mean(dat$T1.TR)
T5.APdatmean<-mean(dat$T5.AP)
T5.TRdatmean<-mean(dat$T5.TR)
T10.APdatmean<-mean(dat$T10.AP)
T10.TRdatmean<-mean(dat$T10.TR)
L1.APdatmean<-mean(dat$L1.AP)
L1.TRdatmean<-mean(dat$L1.TR)
L3.APdatmean<-mean(dat$L3.AP)
L3.TRdatmean<-mean(dat$L3.TR)

FL.Ldatvar<-var(dat$FL_Left)
FL.Rdatvar<-var(dat$FL_Right)
T1.APdatvar<-var(dat$T1.AP)
T1.TRdatvar<-var(dat$T1.TR)
T5.APdatvar<-var(dat$T5.AP)
T5.TRdatvar<-var(dat$T5.TR)
T10.APdatvar<-var(dat$T10.AP)
T10.TRdatvar<-var(dat$T10.TR)
L1.APdatvar<-var(dat$L1.AP)
L1.TRdatvar<-var(dat$L1.TR)
L3.APdatvar<-var(dat$L3.AP)
L3.TRdatvar<-var(dat$L3.TR)

################
Impute the data
###############

#Using the 'mice' package
#m = number of imputations
#maxit = the number of iterations
#method = sets the method. In this case we want random imputation which is "sample"
#seed = set the seed so that you get the same numbers imputed each time you run the code
tempdata.five.1<-mice(cont.five.1, m=10, maxit=50, method="sample", seed=1)
tempdata.five.2<-mice(cont.five.2, m=10, maxit=50, method="sample", seed=1)
tempdata.five.3<-mice(cont.five.3, m=10, maxit=50, method="sample", seed=1)
tempdata.five.4<-mice(cont.five.4, m=10, maxit=50, method="sample", seed=1)
tempdata.five.5<-mice(cont.five.5, m=10, maxit=50, method="sample", seed=1)

#################
Complete and Pool
#################

#Each of the m=10 imputations must be added into the dataset and then all 10 versions pooled into a single dataset
#NOTE that pooling the imputed values at this point prior to running statistical analysis violates Rubin's Rules.
#In this case, since we are only interested in the success of the imputation it is okay to pool now

#ONE
one1<-complete(tempdata.five.1,1)
two1<-complete(tempdata.five.1,2)
three1<-complete(tempdata.five.1,3)
four1<-complete(tempdata.five.1,4)
five1<-complete(tempdata.five.1,5)  
six1<-complete(tempdata.five.1,6) 
seven1<-complete(tempdata.five.1,7) 
eight1<-complete(tempdata.five.1,8) 
nine1<-complete(tempdata.five.1,9) 
ten1<-complete(tempdata.five.1,10)

five_one_imp<-(one1 + two1 + three1 + four1 + five1 + six1 + seven1 + eight1 + nine1 + ten1)/10

#TWO
one2<-complete(tempdata.five.2,1)
two2<-complete(tempdata.five.2,2)
three2<-complete(tempdata.five.2,3)
four2<-complete(tempdata.five.2,4)
five2<-complete(tempdata.five.2,5)
six2<-complete(tempdata.five.2,6) 
seven2<-complete(tempdata.five.2,7) 
eight2<-complete(tempdata.five.2,8) 
nine2<-complete(tempdata.five.2,9) 
ten2<-complete(tempdata.five.2,10)

five_two_imp<-(one2 + two2 + three2 + four2 + five2 + six2 + seven2 + eight2 + nine2 + ten2)/10

#THREE
one3<-complete(tempdata.five.3,1)
two3<-complete(tempdata.five.3,2)
three3<-complete(tempdata.five.3,3)
four3<-complete(tempdata.five.3,4)
five3<-complete(tempdata.five.3,5)  
six3<-complete(tempdata.five.3,6) 
seven3<-complete(tempdata.five.3,7) 
eight3<-complete(tempdata.five.3,8) 
nine3<-complete(tempdata.five.3,9) 
ten3<-complete(tempdata.five.3,10)

five_three_imp<-(one3 + two3 + three3 + four3 + five3 + six3 + seven3 + eight3 + nine3 + ten3)/10

#FOUR
one4<-complete(tempdata.five.4,1)
two4<-complete(tempdata.five.4,2)
three4<-complete(tempdata.five.4,3)
four4<-complete(tempdata.five.4,4)
five4<-complete(tempdata.five.4,5)  
six4<-complete(tempdata.five.4,6) 
seven4<-complete(tempdata.five.4,7) 
eight4<-complete(tempdata.five.4,8) 
nine4<-complete(tempdata.five.4,9) 
ten4<-complete(tempdata.five.4,10)

five_four_imp<-(one4 + two4 + three4 + four4 + five4 + six4 + seven4 + eight4 + nine4 + ten4)/10

#FIVE
one5<-complete(tempdata.five.5,1)
two5<-complete(tempdata.five.5,2)
three5<-complete(tempdata.five.5,3)
four5<-complete(tempdata.five.5,4)
five5<-complete(tempdata.five.5,5) 
six5<-complete(tempdata.five.5,6) 
seven5<-complete(tempdata.five.5,7) 
eight5<-complete(tempdata.five.5,8) 
nine5<-complete(tempdata.five.5,9) 
ten5<-complete(tempdata.five.5,10)

five_five_imp<-(one5 + two5 + three5 + four5 + five5 + six5 + seven5 + eight5 + nine5 + ten5)/10

#################################
#Assess Success of Imputed Values
#################################

#By success, we mean how close the imputed datasets are to the original dataset
#Below, we separate each variable to assess

#ONE
FL.Lmean.random.1<-mean(five_one_imp$FL_L, na.rm=TRUE)
FL.Rmean.random.1<-mean(five_one_imp$FL_R, na.rm=TRUE)
T1.APmean.random.1<-mean(five_one_imp$T1.AP, na.rm=TRUE)
T1.TRmean.random.1<-mean(five_one_imp$T1.TR, na.rm=TRUE)
T5.APmean.random.1<-mean(five_one_imp$T5.AP, na.rm=TRUE)
T5.TRmean.random.1<-mean(five_one_imp$T5.TR, na.rm=TRUE)
T10.APmean.random.1<-mean(five_one_imp$T10.AP, na.rm=TRUE)
T10.TRmean.random.1<-mean(five_one_imp$T10.TR, na.rm=TRUE)
L1.APmean.random.1<-mean(five_one_imp$L1.AP, na.rm=TRUE)
L1.TRmean.random.1<-mean(five_one_imp$L1.TR, na.rm=TRUE)
L3.APmean.random.1<-mean(five_one_imp$L3.AP, na.rm=TRUE)
L3.TRmean.random.1<-mean(five_one_imp$L3.TR, na.rm=TRUE)

FL.Lvar.random.1<-var(five_one_imp$FL_L, na.rm=TRUE)
FL.Rvar.random.1<-var(five_one_imp$FL_R, na.rm=TRUE)
T1.APvar.random.1<-var(five_one_imp$T1.AP, na.rm=TRUE)
T1.TRvar.random.1<-var(five_one_imp$T1.TR, na.rm=TRUE)
T5.APvar.random.1<-var(five_one_imp$T5.AP, na.rm=TRUE)
T5.TRvar.random.1<-var(five_one_imp$T5.TR, na.rm=TRUE)
T10.APvar.random.1<-var(five_one_imp$T10.AP, na.rm=TRUE)
T10.TRvar.random.1<-var(five_one_imp$T10.TR, na.rm=TRUE)
L1.APvar.random.1<-var(five_one_imp$L1.AP, na.rm=TRUE)
L1.TRvar.random.1<-var(five_one_imp$L1.TR, na.rm=TRUE)
L3.APvar.random.1<-var(five_one_imp$L3.AP, na.rm=TRUE)
L3.TRvar.random.1<-var(five_one_imp$L3.TR, na.rm=TRUE)

#TWO
FL.Lmean.random.2<-mean(five_two_imp$FL_L, na.rm=TRUE)
FL.Rmean.random.2<-mean(five_two_imp$FL_R, na.rm=TRUE)
T1.APmean.random.2<-mean(five_two_imp$T1.AP, na.rm=TRUE)
T1.TRmean.random.2<-mean(five_two_imp$T1.TR, na.rm=TRUE)
T5.APmean.random.2<-mean(five_two_imp$T5.AP, na.rm=TRUE)
T5.TRmean.random.2<-mean(five_two_imp$T5.TR, na.rm=TRUE)
T10.APmean.random.2<-mean(five_two_imp$T10.AP, na.rm=TRUE)
T10.TRmean.random.2<-mean(five_two_imp$T10.TR, na.rm=TRUE)
L1.APmean.random.2<-mean(five_two_imp$L1.AP, na.rm=TRUE)
L1.TRmean.random.2<-mean(five_two_imp$L1.TR, na.rm=TRUE)
L3.APmean.random.2<-mean(five_two_imp$L3.AP, na.rm=TRUE)
L3.TRmean.random.2<-mean(five_two_imp$L3.TR, na.rm=TRUE)

FL.Lvar.random.2<-var(five_two_imp$FL_L, na.rm=TRUE)
FL.Rvar.random.2<-var(five_two_imp$FL_R, na.rm=TRUE)
T1.APvar.random.2<-var(five_two_imp$T1.AP, na.rm=TRUE)
T1.TRvar.random.2<-var(five_two_imp$T1.TR, na.rm=TRUE)
T5.APvar.random.2<-var(five_two_imp$T5.AP, na.rm=TRUE)
T5.TRvar.random.2<-var(five_two_imp$T5.TR, na.rm=TRUE)
T10.APvar.random.2<-var(five_two_imp$T10.AP, na.rm=TRUE)
T10.TRvar.random.2<-var(five_two_imp$T10.TR, na.rm=TRUE)
L1.APvar.random.2<-var(five_two_imp$L1.AP, na.rm=TRUE)
L1.TRvar.random.2<-var(five_two_imp$L1.TR, na.rm=TRUE)
L3.APvar.random.2<-var(five_two_imp$L3.AP, na.rm=TRUE)
L3.TRvar.random.2<-var(five_two_imp$L3.TR, na.rm=TRUE)

#THREE
FL.Lmean.random.3<-mean(five_three_imp$FL_L, na.rm=TRUE)
FL.Rmean.random.3<-mean(five_three_imp$FL_R, na.rm=TRUE)
T1.APmean.random.3<-mean(five_three_imp$T1.AP, na.rm=TRUE)
T1.TRmean.random.3<-mean(five_three_imp$T1.TR, na.rm=TRUE)
T5.APmean.random.3<-mean(five_three_imp$T5.AP, na.rm=TRUE)
T5.TRmean.random.3<-mean(five_three_imp$T5.TR, na.rm=TRUE)
T10.APmean.random.3<-mean(five_three_imp$T10.AP, na.rm=TRUE)
T10.TRmean.random.3<-mean(five_three_imp$T10.TR, na.rm=TRUE)
L1.APmean.random.3<-mean(five_three_imp$L1.AP, na.rm=TRUE)
L1.TRmean.random.3<-mean(five_three_imp$L1.TR, na.rm=TRUE)
L3.APmean.random.3<-mean(five_three_imp$L3.AP, na.rm=TRUE)
L3.TRmean.random.3<-mean(five_three_imp$L3.TR, na.rm=TRUE)

FL.Lvar.random.3<-var(five_three_imp$FL_L, na.rm=TRUE)
FL.Rvar.random.3<-var(five_three_imp$FL_R, na.rm=TRUE)
T1.APvar.random.3<-var(five_three_imp$T1.AP, na.rm=TRUE)
T1.TRvar.random.3<-var(five_three_imp$T1.TR, na.rm=TRUE)
T5.APvar.random.3<-var(five_three_imp$T5.AP, na.rm=TRUE)
T5.TRvar.random.3<-var(five_three_imp$T5.TR, na.rm=TRUE)
T10.APvar.random.3<-var(five_three_imp$T10.AP, na.rm=TRUE)
T10.TRvar.random.3<-var(five_three_imp$T10.TR, na.rm=TRUE)
L1.APvar.random.3<-var(five_three_imp$L1.AP, na.rm=TRUE)
L1.TRvar.random.3<-var(five_three_imp$L1.TR, na.rm=TRUE)
L3.APvar.random.3<-var(five_three_imp$L3.AP, na.rm=TRUE)
L3.TRvar.random.3<-var(five_three_imp$L3.TR, na.rm=TRUE)

#FOUR
FL.Lmean.random.4<-mean(five_four_imp$FL_L, na.rm=TRUE)
FL.Rmean.random.4<-mean(five_four_imp$FL_R, na.rm=TRUE)
T1.APmean.random.4<-mean(five_four_imp$T1.AP, na.rm=TRUE)
T1.TRmean.random.4<-mean(five_four_imp$T1.TR, na.rm=TRUE)
T5.APmean.random.4<-mean(five_four_imp$T5.AP, na.rm=TRUE)
T5.TRmean.random.4<-mean(five_four_imp$T5.TR, na.rm=TRUE)
T10.APmean.random.4<-mean(five_four_imp$T10.AP, na.rm=TRUE)
T10.TRmean.random.4<-mean(five_four_imp$T10.TR, na.rm=TRUE)
L1.APmean.random.4<-mean(five_four_imp$L1.AP, na.rm=TRUE)
L1.TRmean.random.4<-mean(five_four_imp$L1.TR, na.rm=TRUE)
L3.APmean.random.4<-mean(five_four_imp$L3.AP, na.rm=TRUE)
L3.TRmean.random.4<-mean(five_four_imp$L3.TR, na.rm=TRUE)

FL.Lvar.random.4<-var(five_four_imp$FL_L, na.rm=TRUE)
FL.Rvar.random.4<-var(five_four_imp$FL_R, na.rm=TRUE)
T1.APvar.random.4<-var(five_four_imp$T1.AP, na.rm=TRUE)
T1.TRvar.random.4<-var(five_four_imp$T1.TR, na.rm=TRUE)
T5.APvar.random.4<-var(five_four_imp$T5.AP, na.rm=TRUE)
T5.TRvar.random.4<-var(five_four_imp$T5.TR, na.rm=TRUE)
T10.APvar.random.4<-var(five_four_imp$T10.AP, na.rm=TRUE)
T10.TRvar.random.4<-var(five_four_imp$T10.TR, na.rm=TRUE)
L1.APvar.random.4<-var(five_four_imp$L1.AP, na.rm=TRUE)
L1.TRvar.random.4<-var(five_four_imp$L1.TR, na.rm=TRUE)
L3.APvar.random.4<-var(five_four_imp$L3.AP, na.rm=TRUE)
L3.TRvar.random.4<-var(five_four_imp$L3.TR, na.rm=TRUE)

#FIVE
FL.Lmean.random.5<-mean(five_five_imp$FL_L, na.rm=TRUE)
FL.Rmean.random.5<-mean(five_five_imp$FL_R, na.rm=TRUE)
T1.APmean.random.5<-mean(five_five_imp$T1.AP, na.rm=TRUE)
T1.TRmean.random.5<-mean(five_five_imp$T1.TR, na.rm=TRUE)
T5.APmean.random.5<-mean(five_five_imp$T5.AP, na.rm=TRUE)
T5.TRmean.random.5<-mean(five_five_imp$T5.TR, na.rm=TRUE)
T10.APmean.random.5<-mean(five_five_imp$T10.AP, na.rm=TRUE)
T10.TRmean.random.5<-mean(five_five_imp$T10.TR, na.rm=TRUE)
L1.APmean.random.5<-mean(five_five_imp$L1.AP, na.rm=TRUE)
L1.TRmean.random.5<-mean(five_five_imp$L1.TR, na.rm=TRUE)
L3.APmean.random.5<-mean(five_five_imp$L3.AP, na.rm=TRUE)
L3.TRmean.random.5<-mean(five_five_imp$L3.TR, na.rm=TRUE)

FL.Lvar.random.5<-var(five_five_imp$FL_L, na.rm=TRUE)
FL.Rvar.random.5<-var(five_five_imp$FL_R, na.rm=TRUE)
T1.APvar.random.5<-var(five_five_imp$T1.AP, na.rm=TRUE)
T1.TRvar.random.5<-var(five_five_imp$T1.TR, na.rm=TRUE)
T5.APvar.random.5<-var(five_five_imp$T5.AP, na.rm=TRUE)
T5.TRvar.random.5<-var(five_five_imp$T5.TR, na.rm=TRUE)
T10.APvar.random.5<-var(five_five_imp$T10.AP, na.rm=TRUE)
T10.TRvar.random.5<-var(five_five_imp$T10.TR, na.rm=TRUE)
L1.APvar.random.5<-var(five_five_imp$L1.AP, na.rm=TRUE)
L1.TRvar.random.5<-var(five_five_imp$L1.TR, na.rm=TRUE)
L3.APvar.random.5<-var(five_five_imp$L3.AP, na.rm=TRUE)
L3.TRvar.random.5<-var(five_five_imp$L3.TR, na.rm=TRUE)

#Assess Cohen's Kappa and Kendall's Tau 
#Construct a dataframe that puts the actual data values from the real dataset next to each imputed value 
#kappa2 = Cohen's Kappa
#cor.test is the Kendall's tau
#Do for each version of the data. Here it is 5 times

#ONE
FL.L<-cbind(dat$FL_L, five_one_imp$FL_L)
FL.R<-cbind(dat$FL_R, five_one_imp$FL_R)
T1.AP<-cbind(dat$T1.AP, five_one_imp$T1.AP)
T1.TR<-cbind(dat$T1.TR, five_one_imp$T1.TR)
T5.AP<-cbind(dat$T5.AP, five_one_imp$T5.AP)
T5.TR<-cbind(dat$T5.TR, five_one_imp$T5.TR)
T10.AP<-cbind(dat$T10.AP, five_one_imp$T10.AP)
T10.TR<-cbind(dat$T10.TR, five_one_imp$T10.TR)
L1.AP<-cbind(dat$L1.AP, five_one_imp$L1.AP)
L1.TR<-cbind(dat$L1.TR, five_one_imp$L1.TR)
L3.AP<-cbind(dat$L3.AP, five_one_imp$L3.AP)
L3.TR<-cbind(dat$L3.TR, five_one_imp$L3.TR)

FL.Lkrandomone<-kappa2(FL.L)
FL.Rkrandomone<-kappa2(FL.R)
T1.APkrandomone<-kappa2(T1.AP)
T1.TRkrandomone<-kappa2(T1.TR)
T5.APkrandomone<-kappa2(T5.AP)
T5.TRkrandomone<-kappa2(T5.TR)
T10.APkrandomone<-kappa2(T10.AP)
T10.TRkrandomone<-kappa2(T10.TR)
L1.APkrandomone<-kappa2(L1.AP)
L1.TRkrandomone<-kappa2(L1.TR)
L3.APkrandomone<-kappa2(L3.AP)
L3.TRkrandomone<-kappa2(L3.TR)

FL.Ltaurandomone<-cor.test(dat$FL_L, five_one_imp$FL_L, method="kendall")
FL.Rtaurandomone<-cor.test(dat$FL_R, five_one_imp$FL_R, method="kendall")
T1.APtaurandomone<-cor.test(dat$T1.AP, five_one_imp$T1.AP, method="kendall")
T1.TRtaurandomone<-cor.test(dat$T1.TR, five_one_imp$T1.TR, method="kendall")
T5.APtaurandomone<-cor.test(dat$T5.AP, five_one_imp$T5.AP, method="kendall")
T5.TRtaurandomone<-cor.test(dat$T5.TR, five_one_imp$T5.TR, method="kendall")
T10.APtaurandomone<-cor.test(dat$T10.AP, five_one_imp$T10.AP, method="kendall")
T10.TRtaurandomone<-cor.test(dat$T10.TR, five_one_imp$T10.TR, method="kendall")
L1.APtaurandomone<-cor.test(dat$L1.AP, five_one_imp$L1.AP, method="kendall")
L1.TRtaurandomone<-cor.test(dat$L1.TR, five_one_imp$L1.TR, method="kendall")
L3.APtaurandomone<-cor.test(dat$L3.AP, five_one_imp$L3.AP, method="kendall")
L3.TRtaurandomone<-cor.test(dat$L3.TR, five_one_imp$L3.TR, method="kendall")

#TWO
FL.L<-cbind(dat$FL_L, five_two_imp$FL_L)
FL.R<-cbind(dat$FL_R, five_two_imp$FL_R)
T1.AP<-cbind(dat$T1.AP, five_two_imp$T1.AP)
T1.TR<-cbind(dat$T1.TR, five_two_imp$T1.TR)
T5.AP<-cbind(dat$T5.AP, five_two_imp$T5.AP)
T5.TR<-cbind(dat$T5.TR, five_two_imp$T5.TR)
T10.AP<-cbind(dat$T10.AP, five_two_imp$T10.AP)
T10.TR<-cbind(dat$T10.TR, five_two_imp$T10.TR)
L1.AP<-cbind(dat$L1.AP, five_two_imp$L1.AP)
L1.TR<-cbind(dat$L1.TR, five_two_imp$L1.TR)
L3.AP<-cbind(dat$L3.AP, five_two_imp$L3.AP)
L3.TR<-cbind(dat$L3.TR, five_two_imp$L3.TR)

FL.Lkrandomtwo<-kappa2(FL.L)
FL.Rkrandomtwo<-kappa2(FL.R)
T1.APkrandomtwo<-kappa2(T1.AP)
T1.TRkrandomtwo<-kappa2(T1.TR)
T5.APkrandomtwo<-kappa2(T5.AP)
T5.TRkrandomtwo<-kappa2(T5.TR)
T10.APkrandomtwo<-kappa2(T10.AP)
T10.TRkrandomtwo<-kappa2(T10.TR)
L1.APkrandomtwo<-kappa2(L1.AP)
L1.TRkrandomtwo<-kappa2(L1.TR)
L3.APkrandomtwo<-kappa2(L3.AP)
L3.TRkrandomtwo<-kappa2(L3.TR)

FL.Ltaurandomtwo<-cor.test(dat$FL_L, five_two_imp$FL_L, method="kendall")
FL.Rtaurandomtwo<-cor.test(dat$FL_R, five_two_imp$FL_R, method="kendall")
T1.APtaurandomtwo<-cor.test(dat$T1.AP, five_two_imp$T1.AP, method="kendall")
T1.TRtaurandomtwo<-cor.test(dat$T1.TR, five_two_imp$T1.TR, method="kendall")
T5.APtaurandomtwo<-cor.test(dat$T5.AP, five_two_imp$T5.AP, method="kendall")
T5.TRtaurandomtwo<-cor.test(dat$T5.TR, five_two_imp$T5.TR, method="kendall")
T10.APtaurandomtwo<-cor.test(dat$T10.AP, five_two_imp$T10.AP, method="kendall")
T10.TRtaurandomtwo<-cor.test(dat$T10.TR, five_two_imp$T10.TR, method="kendall")
L1.APtaurandomtwo<-cor.test(dat$L1.AP, five_two_imp$L1.AP, method="kendall")
L1.TRtaurandomtwo<-cor.test(dat$L1.TR, five_two_imp$L1.TR, method="kendall")
L3.APtaurandomtwo<-cor.test(dat$L3.AP, five_two_imp$L3.AP, method="kendall")
L3.TRtaurandomtwo<-cor.test(dat$L3.TR, five_two_imp$L3.TR, method="kendall")

#THREE
FL.L<-cbind(dat$FL_L, five_three_imp$FL_L)
FL.R<-cbind(dat$FL_R, five_three_imp$FL_R)
T1.AP<-cbind(dat$T1.AP, five_three_imp$T1.AP)
T1.TR<-cbind(dat$T1.TR, five_three_imp$T1.TR)
T5.AP<-cbind(dat$T5.AP, five_three_imp$T5.AP)
T5.TR<-cbind(dat$T5.TR, five_three_imp$T5.TR)
T10.AP<-cbind(dat$T10.AP, five_three_imp$T10.AP)
T10.TR<-cbind(dat$T10.TR, five_three_imp$T10.TR)
L1.AP<-cbind(dat$L1.AP, five_three_imp$L1.AP)
L1.TR<-cbind(dat$L1.TR, five_three_imp$L1.TR)
L3.AP<-cbind(dat$L3.AP, five_three_imp$L3.AP)
L3.TR<-cbind(dat$L3.TR, five_three_imp$L3.TR)

FL.Lkrandomthree<-kappa2(FL.L)
FL.Rkrandomthree<-kappa2(FL.R)
T1.APkrandomthree<-kappa2(T1.AP)
T1.TRkrandomthree<-kappa2(T1.TR)
T5.APkrandomthree<-kappa2(T5.AP)
T5.TRkrandomthree<-kappa2(T5.TR)
T10.APkrandomthree<-kappa2(T10.AP)
T10.TRkrandomthree<-kappa2(T10.TR)
L1.APkrandomthree<-kappa2(L1.AP)
L1.TRkrandomthree<-kappa2(L1.TR)
L3.APkrandomthree<-kappa2(L3.AP)
L3.TRkrandomthree<-kappa2(L3.TR)

FL.Ltaurandomthree<-cor.test(dat$FL_L, five_three_imp$FL_L, method="kendall")
FL.Rtaurandomthree<-cor.test(dat$FL_R, five_three_imp$FL_R, method="kendall")
T1.APtaurandomthree<-cor.test(dat$T1.AP, five_three_imp$T1.AP, method="kendall")
T1.TRtaurandomthree<-cor.test(dat$T1.TR, five_three_imp$T1.TR, method="kendall")
T5.APtaurandomthree<-cor.test(dat$T5.AP, five_three_imp$T5.AP, method="kendall")
T5.TRtaurandomthree<-cor.test(dat$T5.TR, five_three_imp$T5.TR, method="kendall")
T10.APtaurandomthree<-cor.test(dat$T10.AP, five_three_imp$T10.AP, method="kendall")
T10.TRtaurandomthree<-cor.test(dat$T10.TR, five_three_imp$T10.TR, method="kendall")
L1.APtaurandomthree<-cor.test(dat$L1.AP, five_three_imp$L1.AP, method="kendall")
L1.TRtaurandomthree<-cor.test(dat$L1.TR, five_three_imp$L1.TR, method="kendall")
L3.APtaurandomthree<-cor.test(dat$L3.AP, five_three_imp$L3.AP, method="kendall")
L3.TRtaurandomthree<-cor.test(dat$L3.TR, five_three_imp$L3.TR, method="kendall")

#FOUR
FL.L<-cbind(dat$FL_L, five_four_imp$FL_L)
FL.R<-cbind(dat$FL_R, five_four_imp$FL_R)
T1.AP<-cbind(dat$T1.AP, five_four_imp$T1.AP)
T1.TR<-cbind(dat$T1.TR, five_four_imp$T1.TR)
T5.AP<-cbind(dat$T5.AP, five_four_imp$T5.AP)
T5.TR<-cbind(dat$T5.TR, five_four_imp$T5.TR)
T10.AP<-cbind(dat$T10.AP, five_four_imp$T10.AP)
T10.TR<-cbind(dat$T10.TR, five_four_imp$T10.TR)
L1.AP<-cbind(dat$L1.AP, five_four_imp$L1.AP)
L1.TR<-cbind(dat$L1.TR, five_four_imp$L1.TR)
L3.AP<-cbind(dat$L3.AP, five_four_imp$L3.AP)
L3.TR<-cbind(dat$L3.TR, five_four_imp$L3.TR)

FL.Lkrandomfour<-kappa2(FL.L)
FL.Rkrandomfour<-kappa2(FL.R)
T1.APkrandomfour<-kappa2(T1.AP)
T1.TRkrandomfour<-kappa2(T1.TR)
T5.APkrandomfour<-kappa2(T5.AP)
T5.TRkrandomfour<-kappa2(T5.TR)
T10.APkrandomfour<-kappa2(T10.AP)
T10.TRkrandomfour<-kappa2(T10.TR)
L1.APkrandomfour<-kappa2(L1.AP)
L1.TRkrandomfour<-kappa2(L1.TR)
L3.APkrandomfour<-kappa2(L3.AP)
L3.TRkrandomfour<-kappa2(L3.TR)

FL.Ltaurandomfour<-cor.test(dat$FL_L, five_four_imp$FL_L, method="kendall")
FL.Rtaurandomfour<-cor.test(dat$FL_R, five_four_imp$FL_R, method="kendall")
T1.APtaurandomfour<-cor.test(dat$T1.AP, five_four_imp$T1.AP, method="kendall")
T1.TRtaurandomfour<-cor.test(dat$T1.TR, five_four_imp$T1.TR, method="kendall")
T5.APtaurandomfour<-cor.test(dat$T5.AP, five_four_imp$T5.AP, method="kendall")
T5.TRtaurandomfour<-cor.test(dat$T5.TR, five_four_imp$T5.TR, method="kendall")
T10.APtaurandomfour<-cor.test(dat$T10.AP, five_four_imp$T10.AP, method="kendall")
T10.TRtaurandomfour<-cor.test(dat$T10.TR, five_four_imp$T10.TR, method="kendall")
L1.APtaurandomfour<-cor.test(dat$L1.AP, five_four_imp$L1.AP, method="kendall")
L1.TRtaurandomfour<-cor.test(dat$L1.TR, five_four_imp$L1.TR, method="kendall")
L3.APtaurandomfour<-cor.test(dat$L3.AP, five_four_imp$L3.AP, method="kendall")
L3.TRtaurandomfour<-cor.test(dat$L3.TR, five_four_imp$L3.TR, method="kendall")

#FIVE
FL.L<-cbind(dat$FL_L, five_five_imp$FL_L)
FL.R<-cbind(dat$FL_R, five_five_imp$FL_R)
T1.AP<-cbind(dat$T1.AP, five_five_imp$T1.AP)
T1.TR<-cbind(dat$T1.TR, five_five_imp$T1.TR)
T5.AP<-cbind(dat$T5.AP, five_five_imp$T5.AP)
T5.TR<-cbind(dat$T5.TR, five_five_imp$T5.TR)
T10.AP<-cbind(dat$T10.AP, five_five_imp$T10.AP)
T10.TR<-cbind(dat$T10.TR, five_five_imp$T10.TR)
L1.AP<-cbind(dat$L1.AP, five_five_imp$L1.AP)
L1.TR<-cbind(dat$L1.TR, five_five_imp$L1.TR)
L3.AP<-cbind(dat$L3.AP, five_five_imp$L3.AP)
L3.TR<-cbind(dat$L3.TR, five_five_imp$L3.TR)

FL.Lkrandomfive<-kappa2(FL.L)
FL.Rkrandomfive<-kappa2(FL.R)
T1.APkrandomfive<-kappa2(T1.AP)
T1.TRkrandomfive<-kappa2(T1.TR)
T5.APkrandomfive<-kappa2(T5.AP)
T5.TRkrandomfive<-kappa2(T5.TR)
T10.APkrandomfive<-kappa2(T10.AP)
T10.TRkrandomfive<-kappa2(T10.TR)
L1.APkrandomfive<-kappa2(L1.AP)
L1.TRkrandomfive<-kappa2(L1.TR)
L3.APkrandomfive<-kappa2(L3.AP)
L3.TRkrandomfive<-kappa2(L3.TR)

FL.Ltaurandomfive<-cor.test(dat$FL_L, five_five_imp$FL_L, method="kendall")
FL.Rtaurandomfive<-cor.test(dat$FL_R, five_five_imp$FL_R, method="kendall")
T1.APtaurandomfive<-cor.test(dat$T1.AP, five_five_imp$T1.AP, method="kendall")
T1.TRtaurandomfive<-cor.test(dat$T1.TR, five_five_imp$T1.TR, method="kendall")
T5.APtaurandomfive<-cor.test(dat$T5.AP, five_five_imp$T5.AP, method="kendall")
T5.TRtaurandomfive<-cor.test(dat$T5.TR, five_five_imp$T5.TR, method="kendall")
T10.APtaurandomfive<-cor.test(dat$T10.AP, five_five_imp$T10.AP, method="kendall")
T10.TRtaurandomfive<-cor.test(dat$T10.TR, five_five_imp$T10.TR, method="kendall")
L1.APtaurandomfive<-cor.test(dat$L1.AP, five_five_imp$L1.AP, method="kendall")
L1.TRtaurandomfive<-cor.test(dat$L1.TR, five_five_imp$L1.TR, method="kendall")
L3.APtaurandomfive<-cor.test(dat$L3.AP, five_five_imp$L3.AP, method="kendall")
L3.TRtaurandomfive<-cor.test(dat$L3.TR, five_five_imp$L3.TR, method="kendall")

#Now we combine the results from each of the 5 versions
#This averages the means and variances across all 5 
FL.Lmean.random<-mean(FL.Lmean.random.1, FL.Lmean.random.2, FL.Lmean.random.3, FL.Lmean.random.4, FL.Lmean.random.5)
FL.Rmean.random<-mean(FL.Rmean.random.1, FL.Rmean.random.2, FL.Rmean.random.3, FL.Rmean.random.4, FL.Rmean.random.5)
T1.APmean.random<-mean(T1.APmean.random.1, T1.APmean.random.2, T1.APmean.random.3, T1.APmean.random.4, T1.APmean.random.5)
T1.TRmean.random<-mean(T1.TRmean.random.1, T1.TRmean.random.2, T1.TRmean.random.3, T1.TRmean.random.4, T1.TRmean.random.5)
T5.APmean.random<-mean(T5.APmean.random.1, T5.APmean.random.2, T5.APmean.random.3, T5.APmean.random.4, T5.APmean.random.5)
T5.TRmean.random<-mean(T5.TRmean.random.1, T5.TRmean.random.2, T5.TRmean.random.3, T5.TRmean.random.4, T5.TRmean.random.5)
T10.APmean.random<-mean(T10.APmean.random.1, T10.APmean.random.2, T10.APmean.random.3, T10.APmean.random.4, T10.APmean.random.5)
T10.TRmean.random<-mean(T10.TRmean.random.1, T10.TRmean.random.2, T10.TRmean.random.3, T10.TRmean.random.4, T10.TRmean.random.5)
L1.APmean.random<-mean(L1.APmean.random.1, L1.APmean.random.2, L1.APmean.random.3, L1.APmean.random.4, L1.APmean.random.5)
L1.TRmean.random<-mean(L1.TRmean.random.1, L1.TRmean.random.2, L1.TRmean.random.3, L1.TRmean.random.4, L1.TRmean.random.5)
L3.APmean.random<-mean(L3.APmean.random.1, L3.APmean.random.2, L3.APmean.random.3, L3.APmean.random.4, L3.APmean.random.5)
L3.TRmean.random<-mean(L3.TRmean.random.1, L3.TRmean.random.2, L3.TRmean.random.3, L3.TRmean.random.4, L3.TRmean.random.5)

FL.Lvar.random<-mean(FL.Lvar.random.1, FL.Lvar.random.2, FL.Lvar.random.3, FL.Lvar.random.4, FL.Lvar.random.5)
FL.Rvar.random<-mean(FL.Rvar.random.1, FL.Rvar.random.2, FL.Rvar.random.3, FL.Rvar.random.4, FL.Rvar.random.5)
T1.APvar.random<-mean(T1.APvar.random.1, T1.APvar.random.2, T1.APvar.random.3, T1.APvar.random.4, T1.APvar.random.5)
T1.TRvar.random<-mean(T1.TRvar.random.1, T1.TRvar.random.2, T1.TRvar.random.3, T1.TRvar.random.4, T1.TRvar.random.5)
T5.APvar.random<-mean(T5.APvar.random.1, T5.APvar.random.2, T5.APvar.random.3, T5.APvar.random.4, T5.APvar.random.5)
T5.TRvar.random<-mean(T5.TRvar.random.1, T5.TRvar.random.2, T5.TRvar.random.3, T5.TRvar.random.4, T5.TRvar.random.5)
T10.APvar.random<-mean(T10.APvar.random.1, T10.APvar.random.2, T10.APvar.random.3, T10.APvar.random.4, T10.APvar.random.5)
T10.TRvar.random<-mean(T10.TRvar.random.1, T10.TRvar.random.2, T10.TRvar.random.3, T10.TRvar.random.4, T10.TRvar.random.5)
L1.APvar.random<-mean(L1.APvar.random.1, L1.APvar.random.2, L1.APvar.random.3, L1.APvar.random.4, L1.APvar.random.5)
L1.TRvar.random<-mean(L1.TRvar.random.1, L1.TRvar.random.2, L1.TRvar.random.3, L1.TRvar.random.4, L1.TRvar.random.5)
L3.APvar.random<-mean(L3.APvar.random.1, L3.APvar.random.2, L3.APvar.random.3, L3.APvar.random.4, L3.APvar.random.5)
L3.TRvar.random<-mean(L3.TRvar.random.1, L3.TRvar.random.2, L3.TRvar.random.3, L3.TRvar.random.4, L3.TRvar.random.5)

#Now we combine the results from each of the 5 versions
#This averages the kappa and tau across all 5 
FL.Lkmean<-mean(FL.Lkrandomone$value, FL.Lkrandomtwo$value, FL.Lkrandomthree$value, FL.Lkrandomfour$value, FL.Lkrandomfive$value)
FL.Rkmean<-mean(FL.Rkrandomone$value, FL.Rkrandomtwo$value, FL.Rkrandomthree$value, FL.Rkrandomfour$value, FL.Rkrandomfive$value)
T1.APkmean<-mean(T1.APkrandomone$value, T1.APkrandomtwo$value,T1.APkrandomthree$value, T1.APkrandomfour$value, T1.APkrandomfive$value)
T1.TRkmean<-mean(T1.TRkrandomone$value, T1.TRkrandomtwo$value,T1.TRkrandomthree$value, T1.TRkrandomfour$value, T1.TRkrandomfive$value)
T5.APkmean<-mean(T5.APkrandomone$value, T5.APkrandomtwo$value,T5.APkrandomthree$value, T5.APkrandomfour$value, T5.APkrandomfive$value)
T5.TRkmean<-mean(T5.TRkrandomone$value, T5.TRkrandomtwo$value,T5.TRkrandomthree$value, T5.TRkrandomfour$value, T5.TRkrandomfive$value)
T10.APkmean<-mean(T10.APkrandomone$value, T10.APkrandomtwo$value,T10.APkrandomthree$value, T10.APkrandomfour$value, T10.APkrandomfive$value)
T10.TRkmean<-mean(T10.TRkrandomone$value, T10.TRkrandomtwo$value,T10.TRkrandomthree$value, T10.TRkrandomfour$value, T10.TRkrandomfive$value)
L1.APkmean<-mean(L1.APkrandomone$value, L1.APkrandomtwo$value,L1.APkrandomthree$value, L1.APkrandomfour$value, L1.APkrandomfive$value)
L1.TRkmean<-mean(L1.TRkrandomone$value, L1.TRkrandomtwo$value,L1.TRkrandomthree$value, L1.TRkrandomfour$value, L1.TRkrandomfive$value)
L3.APkmean<-mean(L3.APkrandomone$value, L3.APkrandomtwo$value,L3.APkrandomthree$value, L3.APkrandomfour$value, L3.APkrandomfive$value)
L3.TRkmean<-mean(L3.TRkrandomone$value, L3.TRkrandomtwo$value,L3.TRkrandomthree$value, L3.TRkrandomfour$value, L3.TRkrandomfive$value)

FL.Ltaumean<-mean(FL.Ltaurandomone$estimate, FL.Ltaurandomtwo$estimate, FL.Ltaurandomthree$estimate, FL.Ltaurandomfour$estimate, FL.Ltaurandomfive$estimate)
FL.Rtaumean<-mean(FL.Rtaurandomone$estimate, FL.Rtaurandomtwo$estimate, FL.Rtaurandomthree$estimate, FL.Rtaurandomfour$estimate, FL.Rtaurandomfive$estimate)
T1.APtaumean<-mean(T1.APtaurandomone$estimate, T1.APtaurandomtwo$estimate,T1.APtaurandomthree$estimate, T1.APtaurandomfour$estimate, T1.APtaurandomfive$estimate)
T1.TRtaumean<-mean(T1.TRtaurandomone$estimate, T1.TRtaurandomtwo$estimate,T1.TRtaurandomthree$estimate, T1.TRtaurandomfour$estimate, T1.TRtaurandomfive$estimate)
T5.APtaumean<-mean(T5.APtaurandomone$estimate, T5.APtaurandomtwo$estimate,T5.APtaurandomthree$estimate, T5.APtaurandomfour$estimate, T5.APtaurandomfive$estimate)
T5.TRtaumean<-mean(T5.TRtaurandomone$estimate, T5.TRtaurandomtwo$estimate,T5.TRtaurandomthree$estimate, T5.TRtaurandomfour$estimate, T5.TRtaurandomfive$estimate)
T10.APtaumean<-mean(T10.APtaurandomone$estimate, T10.APtaurandomtwo$estimate,T10.APtaurandomthree$estimate, T10.APtaurandomfour$estimate, T10.APtaurandomfive$estimate)
T10.TRtaumean<-mean(T10.TRtaurandomone$estimate, T10.TRtaurandomtwo$estimate,T10.TRtaurandomthree$estimate, T10.TRtaurandomfour$estimate, T10.TRtaurandomfive$estimate)
L1.APtaumean<-mean(L1.APtaurandomone$estimate, L1.APtaurandomtwo$estimate,L1.APtaurandomthree$estimate, L1.APtaurandomfour$estimate, L1.APtaurandomfive$estimate)
L1.TRtaumean<-mean(L1.TRtaurandomone$estimate, L1.TRtaurandomtwo$estimate,L1.TRtaurandomthree$estimate, L1.TRtaurandomfour$estimate, L1.TRtaurandomfive$estimate)
L3.APtaumean<-mean(L3.APtaurandomone$estimate, L3.APtaurandomtwo$estimate,L3.APtaurandomthree$estimate, L3.APtaurandomfour$estimate, L3.APtaurandomfive$estimate)
L3.TRtaumean<-mean(L3.TRtaurandomone$estimate, L3.TRtaurandomtwo$estimate,L3.TRtaurandomthree$estimate, L3.TRtaurandomfour$estimate, L3.TRtaurandomfive$estimate)

###################################
#Calculate Percent Error and Export
###################################

#This final chunk calculates the %error between actual and observed (imputed) values for the mean and variance
#Cohen's Kappa and Kendall's Tau produce the coefficient which shows the level of agreement
#The matrix puts the values in a row or column and exports as a .csv

ab<-c((abs((FL.Lmean.random-FL.Ldatmean)/FL.Ldatmean)*100),(abs((FL.Rmean.random-FL.Rdatmean)/FL.Rdatmean)*100),(abs((T1.APmean.random-T1.APdatmean)/T1.APdatmean)*100),(abs((T1.TRmean.random-T1.TRdatmean)/T1.TRdatmean)*100),(abs((T5.APmean.random-T5.APdatmean)/T5.APdatmean)*100), (abs((T5.TRmean.random-T5.TRdatmean)/T5.TRdatmean)*100), (abs((T10.APmean.random-T10.APdatmean)/T10.APdatmean)*100), (abs((T10.TRmean.random-T10.TRdatmean)/T10.TRdatmean)*100), (abs((L1.APmean.random-L1.APdatmean)/L1.APdatmean)*100), (abs((L1.TRmean.random-L1.TRdatmean)/L1.TRdatmean)*100), (abs((L3.APmean.random-L3.APdatmean)/L3.APdatmean)*100), (abs((L3.TRmean.random-L3.TRdatmean)/L3.TRdatmean)*100))

ac<-c((abs((FL.Lvar.random-FL.Ldatvar)/FL.Ldatvar)*100),(abs((FL.Rvar.random-FL.Rdatvar)/FL.Rdatvar)*100),(abs((T1.APvar.random-T1.APdatvar)/T1.APdatvar)*100),(abs((T1.TRvar.random-T1.TRdatvar)/T1.TRdatvar)*100),(abs((T5.APvar.random-T5.APdatvar)/T5.APdatvar)*100), (abs((T5.TRvar.random-T5.TRdatvar)/T5.TRdatvar)*100), (abs((T10.APvar.random-T10.APdatvar)/T10.APdatvar)*100), (abs((T10.TRvar.random-T10.TRdatvar)/T10.TRdatvar)*100), (abs((L1.APvar.random-L1.APdatvar)/L1.APdatvar)*100), (abs((L1.TRvar.random-L1.TRdatvar)/L1.TRdatvar)*100), (abs((L3.APvar.random-L3.APdatvar)/L3.APdatvar)*100), (abs((L3.TRvar.random-L3.TRdatvar)/L3.TRdatvar)*100))

ad<-matrix(c(FL.Lkmean, FL.Rkmean, T1.APkmean, T1.TRkmean, T5.APkmean, T5.TRkmean, T10.APkmean, T10.TRkmean, L1.APkmean, L1.TRkmean, L3.APkmean, L3.TRkmean), 12, 1)

ae<-matrix(c(FL.Ltaumean, FL.Rtaumean, T1.APtaumean, T1.TRtaumean, T5.APtaumean, T5.TRtaumean, T10.APtaumean, T10.TRtaumean, L1.APtaumean, L1.TRtaumean, L3.APtaumean, L3.TRtaumean), 12, 1)

dfmean<-data.frame(cbind(ab, ac, ad, ae))
colnames(dfmean)<-c("mean", "var", "kappa", "tau")
rownames(dfmean)<-c("FL.L", "FL.R", "T1.AP", "T1.TR", "T5.AP", "T5.TR", "T10.AP", "T10.TR", "L1.AP", "L1.TR", "L3.AP", "L3.TR")
write.csv(dfmean, file="imputed_data.csv")

#END